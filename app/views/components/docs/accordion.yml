name: Accordion
description: A group of expanding/collapsing sections
body: |
  The accordion has several features:

  - Opening a section changes the URL so that if the URL is shared or the user uses the back button on the next page, the page will load at that part of the accordion with it expanded.
  - If JavaScript is disabled the accordion expands fully. All of the accordion functionality (including the icons and aria attributes) are added using JavaScript.
accessibility_criteria: |
  The accordion must:

  - indicate to users that each section can be expanded and collapsed
  - be usable with a keyboard
  - use a button element for section toggling for easier keyboard use and to prevent user confusion
  - allow users to open or close all sections at once

  When JavaScript is unavailable the accordion must:

  - be fully expanded
  - not be marked as expandable
shared_accessibility_criteria:
  - link
examples:
  default:
    block: |
      <div class="description">
        <%= section[:panel] %>
      </div>
    block_arguments:
      - section
    data:
      sections: [
        {
          title: 'First accordion header',
          panel: 'First accordion panel'
        },
        {
          title: 'Second accordion header',
          panel: 'Second accordion panel'
        },
        {
          title: 'Third accordion header lets see how long we can make it and what that does',
          panel: 'Third accordion panel also containing some deliberately long content to show what happens with that'
        }
      ]
  complex:
    description: Complex markup can be passed for the accordion panels, but the styling for that content should not come from the component itself.
    block: |
      <div class="govuk-govspeak">
        <% if section[:show_subscriptions] %>
          <div class="subscriptions">
            <a href="/email-signup/?topic=<%= section[:base_path] %>" class="email-alerts">
              Get email alerts for this topic
              <span class="visuallyhidden"><%= section[:title] %></span>
            </a>
          </div>
        <% end %>

        <ol class="subsection-list">
          <% section[:subsections].each do |subsection| %>
            <li>
              <a href="<%= subsection[:base_path] %>">
                <%= subsection[:title] %>
              </a>
              <p>
                <%= subsection[:description] %>
              </p>
            </li>
          <% end %>
        </ol>
      </div>
    block_arguments:
      - section
    data:
      sections: [
        {
          title: 'General information and guidance',
          subsections: [
            {
              title: 'Assessment component files: 2013',
              base_path: '/government/publications/assessment-component-files-2013',
              description: 'Assessment framework specification files for software suppliers developing management information systems (MIS).'
            },
            {
              title: 'Assessment component files: 2014',
              base_path: '/government/publications/assessment-component-files-2014',
              description: 'Assessment framework specification files for software suppliers developing management information systems (MIS).'
            },
            {
              title: 'COLLECT guides for schools and local authorities',
              base_path: '/government/publications/collect-guides-for-schools-and-local-authorities',
              description: 'Guides for schools and local authorities submitting data using COLLECT.'
            }
          ]
        },
        {
          title: 'Alternative provision censuses',
          base_path: '/education/alternative-provision-censuses',
          show_subscriptions: true,
          subsections: [
            {
              title: 'Alternative provision census 2018: guide',
              base_path: '/government/publications/alternative-provision-census-2018-guide',
              description: 'Guide for local authorities and providers of alternative provision to help them complete and submit alternative provision census 2018 data.'
            },
            {
              title: 'Alternative provision census 2018: technical specification',
              base_path: '/government/publications/alternative-provision-census-2018-technical-specification',
              description: 'Business and technical specification for local authorities and software suppliers to prepare for the alternative provision census 2018.'
            }
          ]
        },
        {
          title: 'General hospital school censuses',
          base_path: '/education/general-hospital-school-censuses',
          show_subscriptions: true,
          subsections: [
            {
              title: 'General hospital school census 2016: COLLECT guide',
              base_path: '/government/publications/general-hospital-school-census-2016-collect-guide',
              description: 'How to use COLLECT, DfEs data collection and management system, to complete and submit the 2016 general hospital school census.',
            },
            {
              title: 'General hospital school census guide',
              base_path: '/government/publications/general-hospital-school-census-guide',
              description: 'Guide to help general hospital schools complete their annual census.'
            }
          ]
        },
      ]
  with_descriptions:
    description: Descriptive text can be included in the accordion header.
    block: |
      <%= section[:panel] %>
    block_arguments:
      - section
    data:
      sections: [
        {
          title: 'Accordion section with description',
          description: 'This is the description',
          panel: 'Panel content'
        },
        {
          title: 'Accordion section without description',
          panel: 'Panel content'
        },
      ]
  with_custom_section_ids:
    description: IDs for accordion sections are automatically generated based on the section title, but can also be passed manually. Passed IDs are converted to lowercase and have spaces replaced with hyphens.
    block: |
      <%= section[:panel] %>
    block_arguments:
      - section
    data:
      sections: [
        {
          title: 'First accordion header',
          id: 'something1',
          panel: 'First accordion panel'
        },
        {
          title: 'Second accordion header',
          id: 'something2',
          panel: 'Second accordion panel'
        }
      ]
  with_section_indices:
    description: The block is also passed the index of the section as the second argument
    block: |
      <%= index %>
    block_arguments:
      - section
      - index
    data:
      sections: [
        {
          title: 'First section (index 0)',
        },
        {
          title: 'Second section (index 1)',
        },
      ]
